â€”------------------------
select * from client_master;

desc client_master;

ALTER TABLE CLIENT_MASTER ADD CONSTRAINT CLIENT_MASTER_PK PRIMARY KEY (CLIENT_NO );

CREATE TABLE CLIENT_MASTER(
    CLIENT_NO CHAR(6) PRIMARY KEY,
    NAME VARCHAR2(20) NOT NULL,
    ADDRESS VARCHAR2(100),
    CITY VARCHAR2(15),
    PINCODE NUMBER(6),
    STATE VARCHAR2(20),
    BAL_DUE NUMBER(8,2)
);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00001', 'Ivan Bayross', 'F-111', 'Bombay', '400054', 'Maharashtra', 15000);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00002', 'Vandana', 'F-112', 'Madras', '780001', 'Tamil Nadu', 0);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00003', 'Praveen', 'F-113', 'Bombay', '400057', 'Maharashtra', 5000);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00004', 'Basu', 'F-114', 'Bangalore', '560001', 'Karnataka');

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00005', 'Ravi', 'F-115', 'Delhi', '110005', 'Delhi');

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00006', 'Rukhmani', 'F-116', 'Bombay', '400060', 'Maharashtra');



-- question 1

SELECT name, state, city, pincode
FROM client_master
WHERE city = (SELECT city FROM client_master WHERE name = 'Basu')
AND name != 'Basu';

-- question 2

SELECT *
FROM CLIENT_MASTER
WHERE CITY = (SELECT CITY FROM CLIENT_MASTER WHERE NAME = 'Basu')
AND BAL_DUE = (SELECT BAL_DUE FROM CLIENT_MASTER WHERE NAME = 'Basu')
AND NAME != 'Basu';

ALTER TABLE CLIENT_MASTER
DROP COLUMN ADDRESS2;

-- question 3

CREATE TABLE PRODUCT_MASTER(
    PRODUCT_NO CHAR(6) PRIMARY KEY,
    DESCRIPTION VARCHAR2(15) NOT NULL,
    PROFITPERCENT NUMBER (4,2) NOT NULL,
    UNITMEASURE VARCHAR2(10) NOT NULL,
    QTYONHAND NUMBER(8) NOT NULL,
    REORDERLVL NUMBER(8) NOT NULL,
    SELLPRICE NUMBER(8,2) NOT NULL,
    COSTPRICE NUMBER(8,2) NOT NULL
);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00001', '1.44 Floppies', 5, 'Price', 100, 20, 525, 500);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00002', 'Monitors', 6, 'Price', 10, 3, 12000, 11280);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00003', 'Mouse', 5, 'Price', 20, 5, 1050, 1000);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00004', '1.22 Floppies', 5,'Price', 100 ,20 ,525 ,500);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO ,DESCRIPTION ,PROFITPERCENT ,UNITMEASURE ,QTYONHAND ,REORDERLVL ,SELLPRICE ,COSTPRICE)
VALUES ('P00005' ,'Keyboard' ,2 ,'Price' ,10 ,3 ,3150 ,3050);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO ,DESCRIPTION ,PROFITPERCENT ,UNITMEASURE ,QTYONHAND ,REORDERLVL ,SELLPRICE ,COSTPRICE)
VALUES ('P00006' ,'540 Hard Drive' ,'2.5' ,'Price' ,'10' ,'3' ,'5250' ,'5100');

SELECT *
FROM PRODUCT_MASTER
WHERE PROFITPERCENT < (SELECT MIN(PROFITPERCENT) FROM PRODUCT_MASTER WHERE DESCRIPTION LIKE '%Drive%');

-- questions 4

CREATE TABLE SALESMAN_MASTER(
    SALESMAN_NO CHAR(6) PRIMARY KEY,
    SALESMANNAME VARCHAR2(20) NOT NULL,
    ADDRESS1 VARCHAR2(30) NOT NULL,
    ADDRESS2 VARCHAR2(30),
    CITY VARCHAR2(20),
    PINCODE NUMBER(6),
    STATE VARCHAR2(20),
    SALAMT NUMBER(8,2) NOT NULL,
    TGTTOGET NUMBER(6,2) NOT NULL,
    YTDSALES NUMBER(6,2) NOT NULL,
    REMARKS VARCHAR2(60)
);

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00001', 'Aman', 'A/14', 'Worli', 'Mumbai', 400002, 'Maharashtra', 3000, 100, 50, 'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00002', 'Omkar', '65', 'Nariman', 'Mumbai', 400001, 'Maharashtra', 3000, 200, 100, 'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00003', 'Raj', 'P-7', 'Bandra', 'Mumbai', 400032, 'Maharashtra', 3000, 200, 100,'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO,SALESMANNAME ,ADDRESS1 ,ADDRESS2 ,CITY ,PINCODE ,STATE ,SALAMT ,TGTTOGET ,YTDSALES ,REMARKS)
VALUES ('S00004','Ashish','A/5','Juhu','Mumbai',400044,'Maharashtra',3500 ,200 ,150,'Good');

select * from SALESMAN_MASTER ;

CREATE TABLE SALES_ORDER(
    ORDER_NO CHAR(6) PRIMARY KEY,
    CLIENT_NO CHAR(6) REFERENCES CLIENT_MASTER,
    ORDERDATE DATE,
    SALESMAN_NO CHAR(6) REFERENCES SALESMAN_MASTER,
    DELIVTYPE CHAR(1) DEFAULT 'F',
    BILLYN CHAR(1),
    DELIVDATE DATE,
    ORDERSTATUS VARCHAR2(10),
    CONSTRAINT CK_DELIVTYPE CHECK(DELIVTYPE IN('P','F')),
    CONSTRAINT CK_DELIVDATE CHECK(DELIVDATE > ORDERDATE),
    CONSTRAINT CK_ORDERSTATUS CHECK(ORDERSTATUS IN('In Process','Fulfilled','Backorder','Cancelled'))
);



select * from client_master;

desc client_master;

ALTER TABLE CLIENT_MASTER ADD CONSTRAINT CLIENT_MASTER_PK PRIMARY KEY (CLIENT_NO );

drop table client_master;

CREATE TABLE CLIENT_MASTER(
    CLIENT_NO CHAR(6) PRIMARY KEY,
    NAME VARCHAR2(20) NOT NULL,
    ADDRESS VARCHAR2(100),
    CITY VARCHAR2(15),
    PINCODE NUMBER(6),
    STATE VARCHAR2(20),
    BAL_DUE NUMBER(8,2)
);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00001', 'Ivan Bayross', 'F-111', 'Bombay', '400054', 'Maharashtra', 15000);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00002', 'Vandana', 'F-112', 'Madras', '780001', 'Tamil Nadu', 0);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE, BAL_DUE)
VALUES ('C00003', 'Praveen', 'F-113', 'Bombay', '400057', 'Maharashtra', 5000);

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00004', 'Basu', 'F-114', 'Bangalore', '560001', 'Karnataka');

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00005', 'Ravi', 'F-115', 'Delhi', '110005', 'Delhi');

INSERT INTO CLIENT_MASTER (CLIENT_NO, NAME, ADDRESS, CITY, PINCODE, STATE)
VALUES ('C00006', 'Rukhmani', 'F-116', 'Bombay', '400060', 'Maharashtra');




CREATE TABLE SALESMAN_MASTER(
    SALESMAN_NO CHAR(6) PRIMARY KEY,
    SALESMANNAME VARCHAR2(20) NOT NULL,
    ADDRESS1 VARCHAR2(30) NOT NULL,
    ADDRESS2 VARCHAR2(30),
    CITY VARCHAR2(20),
    PINCODE NUMBER(6),
    STATE VARCHAR2(20),
    SALAMT NUMBER(8,2) NOT NULL,
    TGTTOGET NUMBER(6,2) NOT NULL,
    YTDSALES NUMBER(6,2) NOT NULL,
    REMARKS VARCHAR2(60)
);

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00001', 'Aman', 'A/14', 'Worli', 'Mumbai', 400002, 'Maharashtra', 3000, 100, 50, 'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00002', 'Omkar', '65', 'Nariman', 'Mumbai', 400001, 'Maharashtra', 3000, 200, 100, 'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO, SALESMANNAME, ADDRESS1, ADDRESS2, CITY, PINCODE, STATE, SALAMT, TGTTOGET, YTDSALES, REMARKS)
VALUES ('S00003', 'Raj', 'P-7', 'Bandra', 'Mumbai', 400032, 'Maharashtra', 3000, 200, 100,'Good');

INSERT INTO SALESMAN_MASTER (SALESMAN_NO,SALESMANNAME ,ADDRESS1 ,ADDRESS2 ,CITY ,PINCODE ,STATE ,SALAMT ,TGTTOGET ,YTDSALES ,REMARKS)
VALUES ('S00004','Ashish','A/5','Juhu','Mumbai',400044,'Maharashtra',3500 ,200 ,150,'Good');

select * from SALESMAN_MASTER ;

CREATE TABLE SALES_ORDER(
    ORDER_NO CHAR(6) PRIMARY KEY,
    CLIENT_NO CHAR(6) REFERENCES CLIENT_MASTER,
    ORDERDATE DATE,
    SALESMAN_NO CHAR(6) REFERENCES SALESMAN_MASTER,
    DELIVTYPE CHAR(1) DEFAULT 'F',
    BILLYN CHAR(1),
    DELIVDATE DATE,
    ORDERSTATUS VARCHAR2(10),
    CONSTRAINT CK_DELIVTYPE CHECK(DELIVTYPE IN('P','F')),
    CONSTRAINT CK_DELIVDATE CHECK(DELIVDATE > ORDERDATE),
    CONSTRAINT CK_ORDERSTATUS CHECK(ORDERSTATUS IN('In Process','Fulfilled','Backorder','Cancelled'))
);

select * from sales_order;


INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19001', 'C00001', TO_DATE('12-JUN-02', 'DD-MON-YY'), 'S00001', 'F', 'N', TO_DATE('20-JUL-02', 'DD-MON-YY'), 'In Process');

INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19002', 'C00002', TO_DATE('02-JUN-02', 'DD-MON-YY'), 'S00002', 'P', 'N', TO_DATE('27-JUN-02', 'DD-MON-YY'), 'Cancelled');

INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19003', 'C00003', TO_DATE('18-FEB-02', 'DD-MON-YY'), 'S00003', 'F', 'Y', TO_DATE('20-FEB-02', 'DD-MON-YY'), 'Fulfilled');

INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19004', 'C00004', TO_DATE('03-APR-02', 'DD-MON-YY'), 'S00001', 'F', 'Y', TO_DATE('07-APR-02', 'DD-MON-YY'), 'Fulfilled');

INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19005', 'C00005', TO_DATE('20-MAY-02', 'DD-MON-YY'), 'S00002', 'P', 'N', TO_DATE('22-MAY-02', 'DD-MON-YY'), 'Cancelled');

INSERT INTO SALES_ORDER (ORDER_NO, CLIENT_NO, ORDERDATE, SALESMAN_NO, DELIVTYPE, BILLYN, DELIVDATE, ORDERSTATUS)
VALUES ('O19006', 'C00006', TO_DATE('24-MAY-02', 'DD-MON-YY'), 'S00004', 'F', 'N', TO_DATE('26-JUL-02', 'DD-MON-YY'), 'In Process');


CREATE TABLE PRODUCT_MASTER(
    PRODUCT_NO CHAR(6) PRIMARY KEY,
    DESCRIPTION VARCHAR2(15) NOT NULL,
    PROFITPERCENT NUMBER (4,2) NOT NULL,
    UNITMEASURE VARCHAR2(10) NOT NULL,
    QTYONHAND NUMBER(8) NOT NULL,
    REORDERLVL NUMBER(8) NOT NULL,
    SELLPRICE NUMBER(8,2) NOT NULL,
    COSTPRICE NUMBER(8,2) NOT NULL
);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00001', '1.44 Floppies', 5, 'Price', 100, 20, 525, 500);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00002', 'Monitors', 6, 'Price', 10, 3, 12000, 11280);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00003', 'Mouse', 5, 'Price', 20, 5, 1050, 1000);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO, DESCRIPTION, PROFITPERCENT, UNITMEASURE, QTYONHAND, REORDERLVL, SELLPRICE, COSTPRICE)
VALUES ('P00004', '1.22 Floppies', 5,'Price', 100 ,20 ,525 ,500);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO ,DESCRIPTION ,PROFITPERCENT ,UNITMEASURE ,QTYONHAND ,REORDERLVL ,SELLPRICE ,COSTPRICE)
VALUES ('P00005' ,'Keyboard' ,2 ,'Price' ,10 ,3 ,3150 ,3050);

INSERT INTO PRODUCT_MASTER (PRODUCT_NO ,DESCRIPTION ,PROFITPERCENT ,UNITMEASURE ,QTYONHAND ,REORDERLVL ,SELLPRICE ,COSTPRICE)
VALUES ('P00006' ,'540 Hard Drive' ,'2.5' ,'Price' ,'10' ,'3' ,'5250' ,'5100');




SELECT DISTINCT c.NAME
FROM client_master c
INNER JOIN SALES_ORDER o ON c.CLIENT_NO = o.CLIENT_NO
WHERE o.ORDERDATE < (SELECT MIN(ORDERDATE) FROM SALES_ORDER WHERE CLIENT_NO = 'C00004');

CREATE TABLE SALES_ORDER_DETAILS(
  ORDER_NO CHAR(6) REFERENCES SALES_ORDER,
  PRODUCT_NO CHAR(6) REFERENCES PRODUCT_MASTER,
  QTYORDERED NUMBER(8),
  QTYDISP NUMBER(8),
  PRODUCTRATE NUMBER(10,2)
);
INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19001', 'P00001', 4, 4, 525);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19001', 'P00006', 2, 1, 5250);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19002', 'P00001', 10, 0, 525);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19003', 'P00005', 3, 3, 3150);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19003', 'P00006', 3, 1, 5250);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19003', 'P00001', 10, 10, 525);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19003', 'P00002', 4, 4, 1050);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19004', 'P00002', 2, 2, 1050);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19004', 'P00003', 1, 1, 12000);

INSERT INTO SALES_ORDER_DETAILS (ORDER_NO, PRODUCT_NO, QTYORDERED, QTYDISP, PRODUCTRATE)
VALUES ('O19006', 'P00001', 10, 5, 525);


select * from SALES_ORDER_DETAILS;
